> Module Section_2_scenario_10
> Using Sections as IRC

```catala
#[test]
declaration scope Section_2_scenario_10:
  output hoh_result content IRC.IndividualTaxReturnSection2bHeadOfHouseholdOutput

scope Section_2_scenario_10:
  # Scenario: §2(b)(2)(B) deems taxpayer not married at close of year because spouse is a nonresident alien at some time during the taxable year.
  # Taxpayer maintains household and child's principal abode > half the year; thus qualifies as head of household under §2(b)(1).
  # Assumption per scenario: c10 is a qualifying child under §152(c).

  definition hoh_result equals
    # Entities
    let t10 equals IRC.Individual { -- id: 1 -- is_counterfactual: false } in
    let s10 equals IRC.Individual { -- id: 2 -- is_counterfactual: false } in
    let c10 equals IRC.Individual { -- id: 3 -- is_counterfactual: false } in
    let h10 equals IRC.Household { -- id: 1 -- is_counterfactual: false } in

    # Marriage event (married prior to tax year)
    let marriage1 equals IRC.MarriageEvent {
      -- id: 1
      -- spouse1: t10
      -- spouse2: s10
      -- marriage_date: Date.of_year_month_day of 2022, 1, 1
      -- is_counterfactual: false
    } in

    # Child resides in taxpayer's household more than half of 2025
    let residence_c10 equals IRC.ResidencePeriodEvent {
      -- id: 1
      -- individual: c10
      -- household: h10
      -- start_date: Date.of_year_month_day of 2025, 1, 1
      -- end_date: Date.of_year_month_day of 2025, 8, 1
      -- is_member_of_household: true
      -- is_principal_place_of_abode: true
      -- is_counterfactual: false
    } in

    # Taxpayer furnishes over half the cost of maintaining the household (62%)
    let maintain_t10 equals IRC.HouseholdMaintenanceEvent {
      -- id: 1
      -- individual: t10
      -- household: h10
      -- start_date: Date.of_year_month_day of 2025, 1, 1
      -- end_date: Date.of_year_month_day of 2025, 12, 31
      -- cost_furnished_percentage: 0.62
      -- is_counterfactual: false
    } in

    # Parenthood (relationship)
    let parent1 equals IRC.ParenthoodEvent {
      -- id: 1
      -- parent: t10
      -- child: c10
      -- start_date: Date.of_year_month_day of 2015, 1, 1
      -- parent_type: IRC.ParentType.Biological
      -- is_counterfactual: false
    } in

    # Residency status periods: spouse is a nonresident alien for part of the year; taxpayer is resident all year
    let nra_s10 equals IRC.NonresidentAlienStatusPeriodEvent {
      -- id: 1
      -- individual: s10
      -- start_date: Date.of_year_month_day of 2025, 1, 15
      -- end_date: Date.of_year_month_day of 2025, 1, 20
      -- residency_status: IRC.ResidencyStatus.NonresidentAlien
      -- is_counterfactual: false
    } in
    let res_t10 equals IRC.NonresidentAlienStatusPeriodEvent {
      -- id: 2
      -- individual: t10
      -- start_date: Date.of_year_month_day of 2025, 1, 1
      -- end_date: Date.of_year_month_day of 2025, 12, 31
      -- residency_status: IRC.ResidencyStatus.Resident
      -- is_counterfactual: false
    } in

    # Individual tax return: Head of Household with c10 as qualifying person
    let hoh_details equals IRC.HeadOfHouseholdVariant {
      -- taxpayer: t10
      -- qualifying_person: c10
      -- itemization_election: false
      -- is_estate_or_trust: false
      -- is_common_trust_fund: false
      -- is_partnership: false
    } in
    let individual_tax_return equals IRC.IndividualTaxReturn {
      -- id: 1
      -- tax_year: 2025
      -- details: IRC.FilingStatusVariant.HeadOfHousehold content hoh_details
    } in

    # Mock §151 exemptions list result (minimal, to satisfy dependency)
    let taxpayer_151_list equals IRC.IndividualSection151ExemptionsListOutput {
      -- individual: t10
      -- spouse_exemption_allowed_151_b: false
      -- individuals_entitled_to_exemptions_under_151: [ t10 ] ++ [ c10 ]
    } in
    let taxpayer_exemptions_list_result equals IRC.TaxpayerExemptionsList151Output {
      -- taxpayer_result: taxpayer_151_list
      -- spouse_result: Absent
      -- individuals_entitled_to_exemptions_under_151: [ t10 ] ++ [ c10 ]
      -- spouse_exemption_allowed_151_b: false
    } in

    # Mock §152 dependents result reflecting assumption: c10 is a qualifying child
    let qc_c10 equals IRC.IndividualSection152QualifyingChildOutput {
      -- individual: c10
      -- taxpayer: t10
      -- is_qualifying_child: true
      -- bears_relationship_152_c_1_A: true
      -- has_same_principal_place_of_abode_152_c_1_B: true
      -- meets_age_requirements_152_c_1_C: true
      -- has_not_filed_joint_return_152_c_1_E: true
    } in
    let taxpayer_dependents_result equals IRC.IndividualSection152DependentsOutput {
      -- taxpayer: t10
      -- dependents_initial: [ c10 ]
      -- dependents_after_152b1: [ c10 ]
      -- dependents_after_152b2: [ c10 ]
      -- qualifying_children: [ qc_c10 ]
      -- qualifying_relatives: []
      -- individual_dependent_statuses: []
    } in

    # Compute §2(b) Head of Household; set legal determinations via context:
    # - §2(b)(2)(B): spouse is NRA at any time during year → considered not married at close
    # - §2(b)(1): maintains household and principal abode > half year for qualifying child → HOH
    (output of IRC.IndividualTaxReturnSection2bHeadOfHousehold with {
      -- individual_tax_return: individual_tax_return
      -- nonresident_alien_status_period_events: [ nra_s10 ] ++ [ res_t10 ]
      -- parenthood_events: [ parent1 ]
      -- household_maintenance_events: [ maintain_t10 ]
      -- residence_period_events: [ residence_c10 ]
      -- marriage_events: [ marriage1 ]
      -- divorce_or_legal_separation_events: []
      -- family_relationship_events: []
      -- birth_events: []
      -- tax_return_events: []
      -- taxpayer_exemptions_list_result: taxpayer_exemptions_list_result
      -- taxpayer_dependents_result: taxpayer_dependents_result
      -- death_events: []
      -- is_surviving_spouse_2_a: false

      # Context booleans per legal analysis:
      -- is_legally_separated_2_b_2_A: false
      -- spouse_is_nonresident_alien_2_b_2_B: true     # §2(b)(2)(B)
      -- spouse_died_during_year_2_b_2_C: false
      -- is_married_at_year_end_2_b_2: false           # deemed not married due to §2(b)(2)(B)
      -- taxpayer_is_nonresident_alien_2_b_3_A: false
      -- head_of_household_disqualified_household_member_dependent_2_b_3_B: false
      -- is_married_at_year_end_2_b_1_A_i_I: false     # child not married at year end
      -- is_not_dependent_by_152b2_2_b_1_A_i_II: false
      -- qualifying_child_meets_2_b_1_A_i: true        # §2(b)(1)(A)(i)
      -- other_dependent_2_b_1_A_ii: false
      -- maintains_household_principal_place_of_abode_more_than_half_year_2_b_1_A: true  # maintenance + > half-year abode
      -- maintains_household_for_father_or_mother_2_b_1_B: false
      -- is_head_of_household_2_b: true                # §2(b)(1) satisfied
    }).main_output

  # Assertions:
  # Tests §2(b)(2)(B): considered not married at close of the year (is_married_at_year_end_2_b_2 = false)
  assertion (hoh_result.is_married_at_year_end_2_b_2 = false)

  # Tests §2(b)(2)(B): spouse is a nonresident alien at any time
  assertion (hoh_result.spouse_is_nonresident_alien_2_b_2_B = true)

  # Tests §2(b)(1): head of household status met
  assertion (hoh_result.is_head_of_household_2_b = true)
```