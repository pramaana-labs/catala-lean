> Module Section_2_scenario_13
> Using Sections as IRC

```catala
#[test]
declaration scope Section_2_scenario_13:
  output section_2b_head_of_household_result content IRC.IndividualTaxReturnSection2bHeadOfHouseholdOutput

scope Section_2_scenario_13:
  # Scenario: §2(b)(3)(B) limitation disallows HOH when the only qualifying person
  # would not be a dependent but for §152(d)(2)(H) (household member rule).
  # Tax year: 2025
  # Tested law refs: §2(b)(3)(B)
  # Assumption per scenario comments:
  # - r13 is a dependent of t13 only by reason of §152(d)(2)(H) (household member),
  #   i.e., no qualifying relationship other than household membership.

  definition section_2b_head_of_household_result equals
    let t13 equals IRC.Individual { -- id: 1 -- is_counterfactual: false } in
    let r13 equals IRC.Individual { -- id: 2 -- is_counterfactual: false } in
    let h13 equals IRC.Household { -- id: 1 -- is_counterfactual: false } in

    # Residence: roommate r13 is a member for the full year and principal place of abode
    let res_r13 equals IRC.ResidencePeriodEvent {
      -- id: 1
      -- individual: r13
      -- household: h13
      -- start_date: Date.of_year_month_day of 2025, 1, 1
      -- end_date: Date.of_year_month_day of 2025, 12, 31
      -- is_member_of_household: true
      -- is_principal_place_of_abode: true
      -- is_counterfactual: false
    } in

    # Household maintenance: taxpayer furnishes over half (60%)
    let hm_t13 equals IRC.HouseholdMaintenanceEvent {
      -- id: 1
      -- individual: t13
      -- household: h13
      -- start_date: Date.of_year_month_day of 2025, 1, 1
      -- end_date: Date.of_year_month_day of 2025, 12, 31
      -- cost_furnished_percentage: 0.6
      -- is_counterfactual: false
    } in

    # Residency status (not a nonresident alien)
    let nra_t13_2025 equals IRC.NonresidentAlienStatusPeriodEvent {
      -- id: 1
      -- individual: t13
      -- start_date: Date.of_year_month_day of 2025, 1, 1
      -- end_date: Date.of_year_month_day of 2025, 12, 31
      -- residency_status: IRC.ResidencyStatus.Resident
      -- is_counterfactual: false
    } in

    # Return details: Head of Household with qualifying person designated as r13
    let hoh_details equals IRC.HeadOfHouseholdVariant {
      -- taxpayer: t13
      -- qualifying_person: r13
      -- itemization_election: false
      -- is_estate_or_trust: false
      -- is_common_trust_fund: false
      -- is_partnership: false
    } in
    let ind_return equals IRC.IndividualTaxReturn {
      -- id: 1
      -- tax_year: 2025
      -- details: IRC.FilingStatusVariant.HeadOfHousehold content hoh_details
    } in

    # Temporary dependent determinations for §151/§152 based on scenario assumptions:
    # r13 is a dependent only because of §152(d)(2)(H) (household member rule)
    let qualrel_r13 equals IRC.IndividualSection152QualifyingRelativeOutput {
      -- individual: r13
      -- taxpayer: t13
      -- is_qualifying_relative: true
      -- is_household_member_152_d_2_H: true         # Household member rule is the sole relationship
      -- bears_relationship_152_d_1_A: false          # No other qualifying relationship
      -- has_no_income_152_d_1_B: true               # Assume no income events -> meets no income test
      -- is_not_qualifying_child_152_d_1_D: true
    } in
    let dep_status_r13 equals IRC.IndividualDependentStatus {
      -- individual: r13
      -- is_qualifying_child: false
      -- is_qualifying_relative: true
      -- is_excepted_under_152_b_2: false
      -- is_ineligible_under_152_b_1: false
    } in
    let deps_152 equals IRC.IndividualSection152DependentsOutput {
      -- taxpayer: t13
      -- dependents_initial: [ r13 ]
      -- dependents_after_152b1: [ r13 ]
      -- dependents_after_152b2: [ r13 ]
      -- qualifying_children: []
      -- qualifying_relatives: [ qualrel_r13 ]
      -- individual_dependent_statuses: [ dep_status_r13 ]
    } in

    let taxpayer_151_list equals IRC.IndividualSection151ExemptionsListOutput {
      -- individual: t13
      -- spouse_exemption_allowed_151_b: false
      -- individuals_entitled_to_exemptions_under_151: [ r13 ]
    } in
    let tx_151 equals IRC.TaxpayerExemptionsList151Output {
      -- taxpayer_result: taxpayer_151_list
      -- spouse_result: Absent
      -- individuals_entitled_to_exemptions_under_151: [ r13 ]
      -- spouse_exemption_allowed_151_b: false
    } in

    # Call §2(b) Head of Household scope.
    # Provide all context booleans explicitly to reflect the legal facts of this scenario.
    (output of IRC.IndividualTaxReturnSection2bHeadOfHousehold with {
      -- individual_tax_return: ind_return
      -- nonresident_alien_status_period_events: [ nra_t13_2025 ]
      -- parenthood_events: []
      -- household_maintenance_events: [ hm_t13 ]
      -- residence_period_events: [ res_r13 ]
      -- marriage_events: []
      -- divorce_or_legal_separation_events: []
      -- family_relationship_events: []
      -- birth_events: []
      -- tax_return_events: []
      -- taxpayer_exemptions_list_result: tx_151
      -- taxpayer_dependents_result: deps_152
      -- death_events: []
      -- is_surviving_spouse_2_a: false

      # §2(b)(2) determinations (marital status/nonresident checks) - all false here
      -- is_legally_separated_2_b_2_A: false
      -- spouse_is_nonresident_alien_2_b_2_B: false
      -- spouse_died_during_year_2_b_2_C: false
      -- is_married_at_year_end_2_b_2: false

      # §2(b)(3) limitations
      -- taxpayer_is_nonresident_alien_2_b_3_A: false
      -- head_of_household_disqualified_household_member_dependent_2_b_3_B: true  # Tests §2(b)(3)(B)

      # §2(b)(1) components
      -- is_married_at_year_end_2_b_1_A_i_I: false
      -- is_not_dependent_by_152b2_2_b_1_A_i_II: false
      -- qualifying_child_meets_2_b_1_A_i: false
      -- other_dependent_2_b_1_A_ii: true
      -- maintains_household_principal_place_of_abode_more_than_half_year_2_b_1_A: true
      -- maintains_household_for_father_or_mother_2_b_1_B: false

      # Final §2(b) status after applying limitations
      -- is_head_of_household_2_b: false
    }).main_output

  # Assertions - ONLY reference the computed scope output:
  # 1) §2(b)(3)(B) limitation applies because the qualifying person would not be a dependent but for §152(d)(2)(H)
  assertion (section_2b_head_of_household_result.head_of_household_disqualified_household_member_dependent_2_b_3_B = true)

  # 2) Final head-of-household status is disallowed (false) after applying §2(b) including the §2(b)(3)(B) limitation
  assertion (section_2b_head_of_household_result.is_head_of_household_2_b = false)
```