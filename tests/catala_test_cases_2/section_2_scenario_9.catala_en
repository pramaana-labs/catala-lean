> Module Section_2_scenario_9
> Using Sections as IRC

```catala
#[test]
declaration scope Section_2_scenario_9:
  output hoh_status content IRC.IndividualTaxReturnSection2bHeadOfHouseholdOutput

scope Section_2_scenario_9:
  # Scenario: §2(b)(2)(A) legal separation → not considered married; §2(b)(1) HOH requirements met
  # Tested law refs: §2(b)(2)(A), §2(b)(1)
  # Assumption: c9 is a qualifying child under §152(c)

  definition hoh_status equals
    # Entities
    let t9 equals IRC.Individual { -- id: 1 -- is_counterfactual: false } in
    let s9 equals IRC.Individual { -- id: 2 -- is_counterfactual: false } in
    let c9 equals IRC.Individual { -- id: 3 -- is_counterfactual: false } in
    let h9 equals IRC.Household { -- id: 1 -- is_counterfactual: false } in

    # Events
    let marriage_1 equals IRC.MarriageEvent {
      -- id: 1
      -- spouse1: t9
      -- spouse2: s9
      -- marriage_date: Date.of_year_month_day of 2019, 6, 1
      -- is_counterfactual: false
    } in
    let sep_maint_1 equals IRC.DivorceOrLegalSeparationEvent {
      -- id: 1
      -- person1: t9
      -- person2: s9
      -- decree_date: Date.of_year_month_day of 2025, 2, 1
      -- decree_type: IRC.DecreeType.SeparateMaintenance
      -- is_counterfactual: false
    } in
    let res_c9 equals IRC.ResidencePeriodEvent {
      -- id: 1
      -- individual: c9
      -- household: h9
      -- start_date: Date.of_year_month_day of 2025, 1, 1
      -- end_date: Date.of_year_month_day of 2025, 9, 1
      -- is_member_of_household: true
      -- is_principal_place_of_abode: true
      -- is_counterfactual: false
    } in
    let maint_t9 equals IRC.HouseholdMaintenanceEvent {
      -- id: 1
      -- individual: t9
      -- household: h9
      -- start_date: Date.of_year_month_day of 2025, 1, 1
      -- end_date: Date.of_year_month_day of 2025, 12, 31
      -- cost_furnished_percentage: 0.6
      -- is_counterfactual: false
    } in
    let parent_t9_c9 equals IRC.ParenthoodEvent {
      -- id: 1
      -- parent: t9
      -- child: c9
      -- start_date: Date.of_year_month_day of 2014, 1, 1
      -- parent_type: IRC.ParentType.Biological
      -- is_counterfactual: false
    } in
    let nra_t9 equals IRC.NonresidentAlienStatusPeriodEvent {
      -- id: 1
      -- individual: t9
      -- start_date: Date.of_year_month_day of 2025, 1, 1
      -- end_date: Date.of_year_month_day of 2025, 12, 31
      -- residency_status: IRC.ResidencyStatus.Resident
      -- is_counterfactual: false
    } in
    let nra_s9 equals IRC.NonresidentAlienStatusPeriodEvent {
      -- id: 2
      -- individual: s9
      -- start_date: Date.of_year_month_day of 2025, 1, 1
      -- end_date: Date.of_year_month_day of 2025, 12, 31
      -- residency_status: IRC.ResidencyStatus.Resident
      -- is_counterfactual: false
    } in

    # Return details: Head of Household with c9 as qualifying person
    let hoh_details equals IRC.HeadOfHouseholdVariant {
      -- taxpayer: t9
      -- qualifying_person: c9
      -- itemization_election: false
      -- is_estate_or_trust: false
      -- is_common_trust_fund: false
      -- is_partnership: false
    } in
    let itr equals IRC.IndividualTaxReturn {
      -- id: 1
      -- tax_year: 2025
      -- details: IRC.FilingStatusVariant.HeadOfHousehold content hoh_details
    } in

    # Temporary dependent results per §152(c) assumption for c9
    let qc_c9 equals IRC.IndividualSection152QualifyingChildOutput {
      -- individual: c9
      -- taxpayer: t9
      -- is_qualifying_child: true
      -- bears_relationship_152_c_1_A: true
      -- has_same_principal_place_of_abode_152_c_1_B: true
      -- meets_age_requirements_152_c_1_C: true
      -- has_not_filed_joint_return_152_c_1_E: true
    } in
    let ind_dep_status_c9 equals IRC.IndividualDependentStatus {
      -- individual: c9
      -- is_qualifying_child: true
      -- is_qualifying_relative: false
      -- is_excepted_under_152_b_2: false
      -- is_ineligible_under_152_b_1: false
    } in
    let deps_result equals IRC.IndividualSection152DependentsOutput {
      -- taxpayer: t9
      -- dependents_initial: [ c9 ]
      -- dependents_after_152b1: [ c9 ]
      -- dependents_after_152b2: [ c9 ]
      -- qualifying_children: [ qc_c9 ]
      -- qualifying_relatives: []
      -- individual_dependent_statuses: [ ind_dep_status_c9 ]
    } in

    # Temporary §151 exemptions list (not relevant to tested conditions; set minimally)
    let taxpayer_exemptions equals IRC.IndividualSection151ExemptionsListOutput {
      -- individual: t9
      -- spouse_exemption_allowed_151_b: false
      -- individuals_entitled_to_exemptions_under_151: []
    } in
    let exemptions_list equals IRC.TaxpayerExemptionsList151Output {
      -- taxpayer_result: taxpayer_exemptions
      -- spouse_result: Absent
      -- individuals_entitled_to_exemptions_under_151: []
      -- spouse_exemption_allowed_151_b: false
    } in

    # Compute §2(b) Head of Household status; set contexts per legal scenario
    (output of IRC.IndividualTaxReturnSection2bHeadOfHousehold with {
      -- individual_tax_return: itr
      -- nonresident_alien_status_period_events: [ nra_t9 ] ++ [ nra_s9 ]
      -- parenthood_events: [ parent_t9_c9 ]
      -- household_maintenance_events: [ maint_t9 ]
      -- residence_period_events: [ res_c9 ]
      -- marriage_events: [ marriage_1 ]
      -- divorce_or_legal_separation_events: [ sep_maint_1 ]
      -- family_relationship_events: []
      -- birth_events: []
      -- tax_return_events: []
      -- taxpayer_exemptions_list_result: exemptions_list
      -- taxpayer_dependents_result: deps_result
      -- death_events: []
      -- is_surviving_spouse_2_a: false

      # Context variables aligning with §2(b)(2)(A) and §2(b)(1)
      -- is_legally_separated_2_b_2_A: true              # §2(b)(2)(A): legally separated → not considered married
      -- spouse_is_nonresident_alien_2_b_2_B: false
      -- spouse_died_during_year_2_b_2_C: false
      -- is_married_at_year_end_2_b_2: false             # Not married at close due to legal separation
      -- taxpayer_is_nonresident_alien_2_b_3_A: false
      -- head_of_household_disqualified_household_member_dependent_2_b_3_B: false

      -- is_married_at_year_end_2_b_1_A_i_I: false       # Child not married disqualification does not apply
      -- is_not_dependent_by_152b2_2_b_1_A_i_II: false   # Child not excluded by §152(b)(2)
      -- qualifying_child_meets_2_b_1_A_i: true          # Qualifying child condition satisfied
      -- other_dependent_2_b_1_A_ii: false
      -- maintains_household_principal_place_of_abode_more_than_half_year_2_b_1_A: true  # Over half-year abode and cost
      -- maintains_household_for_father_or_mother_2_b_1_B: false

      -- is_head_of_household_2_b: true                  # §2(b)(1): head of household status
      -- qualifying_person_qualifying_child_result: Present content qc_c9
    }).main_output

  # Assertions:
  # §2(b)(2)(A): Legally separated under decree of separate maintenance → not considered married
  assertion (hoh_status.is_legally_separated_2_b_2_A = true)

  # §2(b)(1): Not married at close of year, not surviving spouse, and maintains household with qualifying child > half-year
  assertion (hoh_status.is_head_of_household_2_b = true)
```