> Module Section_151_scenario_1
> Using Sections as IRC

```catala
#[test]
declaration scope Section_151_scenario_1:
  output computation content IRC.IRCSimplified

scope Section_151_scenario_1:
  # Scenario: 2017 Single filer with no spouse and no dependents.
  # Tested law refs: §151(a), §151(b), §151(c), §151(d)(1)
  # Notes:
  # - Baseline exemption amount under §151(d)(1) is $2,000 for 2017 (outside §151(d)(5) years).
  # - No spouse present → no spouse exemption under §151(b).
  # - No dependents claimed → no dependent exemptions under §151(c).
  # - Phaseout under §151(d)(3) not implicated here.

  definition computation equals
    let i_t1 equals IRC.Individual {
      -- id: 1
      -- is_counterfactual: false
    } in

    # Tax return event for 2017, not joint, no dependents or qualifying children
    let tre1 equals IRC.TaxReturnEvent {
      -- id: 1
      -- individual: i_t1
      -- tax_year: 2017
      -- filed_joint_return: false
      -- is_only_for_refund_claim: false
      -- qualifying_children: []
      -- dependents: []
      -- is_counterfactual: false
    } in

    # Single filing status individual return for 2017
    let single_details equals IRC.SingleVariant {
      -- taxpayer: i_t1
      -- itemization_election: false
      -- is_estate_or_trust: false
      -- is_common_trust_fund: false
      -- is_partnership: false
    } in
    let individual_tax_return equals IRC.IndividualTaxReturn {
      -- id: 1
      -- tax_year: 2017
      -- details: IRC.FilingStatusVariant.Single content single_details
    } in

    # Dummy organization and employer unemployment excise tax return (required by IRCSimplified)
    let org1 equals IRC.Organization {
      -- id: 1
      -- organization_type: IRC.OrganizationType.Business
      -- is_counterfactual: false
    } in
    let futa_return equals IRC.EmployerUnemploymentExciseTaxReturn {
      -- id: 1
      -- tax_year: 2017
      -- details: IRC.EmployerVariant.GeneralEmployer content IRC.EmployerGeneralVariant { -- employer: org1 }
    } in

    # Compute IRCSimplified (last-resort aggregator), providing all required inputs.
    output of IRC.IRCSimplified with {
      -- individual_tax_return: individual_tax_return
      -- individuals: [ i_t1 ]
      -- organizations: [ org1 ]
      -- birth_events: []
      -- blindness_status_events: []
      -- death_events: []
      -- nonresident_alien_status_period_events: []
      -- marriage_events: []
      -- divorce_or_legal_separation_events: []
      -- residence_period_events: []
      -- household_maintenance_events: []
      -- parenthood_events: []
      -- family_relationship_events: []
      -- tax_return_events: [ tre1 ]
      -- income_events: []
      -- employment_relationship_events: []
      -- wage_payment_events: []
      -- student_enrollment_events: []
      -- hospital_patient_events: []
      -- immigration_admission_events: []
      -- employment_termination_events: []
      -- employer_unemployment_excise_tax_return: futa_return
      -- itemized_deductions: $0
      -- adjusted_gross_income: $0
    }

  # Assertions: Correlate each expected value to scope outputs and tested law refs.

  # exemption_amount_value = 2000
  # §151(d)(1): default exemption amount is $2,000 (2017 is outside §151(d)(5))
  assertion (computation.taxpayer_exemption_result.exemption_amount_base = $2000)

  # taxpayer_exemption_allowed = true
  # §151(a): taxpayer's exemption allowed as a deduction; assert taxpayer is in the §151 entitlement list
  assertion (
    computation.taxpayer_exemptions_list_result.individuals_entitled_to_exemptions_under_151 contains
      computation.taxpayer_exemptions_list_result.taxpayer_result.individual
  )

  # taxpayer_exemption_deduction_amount = 2000
  # §151(a) using the §151(d)(1) exemption amount with no dependents/spouse
  assertion (computation.taxpayer_exemption_result.personal_exemptions_deduction_151_a = $2000)

  # spouse_exemption_allowed = false
  # §151(b): no spouse, so no spouse exemption allowed
  assertion (computation.taxpayer_exemptions_list_result.spouse_exemption_allowed_151_b = false)

  # spouse_exemption_deduction_amount = 0
  # With no spouse, spouse_result is Absent (implying $0 spouse exemption deduction)
  assertion (computation.taxpayer_exemptions_list_result.spouse_result with pattern Absent)

  # dependents_count_for_taxpayer = 0
  # §151(c) and §152: no dependents claimed, so the dependents list should be empty
  assertion (number of computation.taxpayer_dependents_result.dependents_after_152b2 = 0)

  # dependents_exemptions_deduction_amount = 0
  # No dependents means no deduction attributable to §151(c) dependents.
  # Reflected by total deduction equalling the taxpayer's single exemption.
  assertion (computation.taxpayer_exemption_result.personal_exemptions_deduction_151_a = $2000)

  # total_exemptions_deduction = 2000
  # §151(a): total deduction under §151 on this return (only the taxpayer) is $2,000
  assertion (computation.taxpayer_exemption_result.personal_exemptions_deduction_151_a = $2000)
```